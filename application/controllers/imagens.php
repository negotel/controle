<?phpdefined('BASEPATH') OR exit('<h1 style="text-transform: uppercase; font-weight: 300; color: red; text-align:center; margin-top: 20%;">Acesso n√£o permitido</h1>');class Imagens extends CI_Controller {    function __construct() {        parent::__construct();        if ((!$this->session->userdata('session_id')) || (!$this->session->userdata('logado'))) {            redirect('dashboard/login');        }        $this->load->library('form_validation');        $this->load->helper(array('form', 'codegen_helper'));        $this->load->library('pagination');        $this->data['title'] = 'Imagens';        $this->data['imagens'] = 'Imagens';        $this->load->model('all_model', '', TRUE);        $this->data['dadosUsuario'] = $this->all_model->obterID('user', 'user_perfil', 'user_perfil.id_user = user.idUser', 'idUser', $this->session->userdata('idUser'));        $this->data['config'] = $this->all_model->obterID('config_sistema', '', '', 'idConfig', '1');    }    public function index() {        $this->data['lImagens'] = 'Imagens';        $this->data['view'] = 'imagens/imagens';        $this->load->view('tema/home', $this->data);    }        function imagesLista(){                $page = $this->input->get('page');        $capas = $this->all_model->obterImagens($page);                foreach ($capas as $capa) {            $html = "                <div class='col-lg-4'>                    <div class='card'>                        <h4 class='card-title'><strong>$capa->nome_imagem</strong></h4>                        <div class='card-body'>                            <figure class='teaser teaser-zoe'>                                <img src='".base_url('assets/img/bg/'.$capa->nome_imagem)."' alt='$capa->autor_imagem'>                                <figcaption>                                    <h3>$capa->autor_imagem</h3>                                    <p class='icon-links'>                                        <a href='#'><span class='fa fa-fw1 fa-close'></span></a>                                        <a href='#'><span class='fa fa-fw1 fa-pencil'></span></a>                                        <a href='#'><span class='fa fa-fw1 fa-heart'></span></a>                                    </p>                                    <p class='description'>Zoe never had the patience of her sisters. She deliberately punched the bear in his face.</p>                                </figcaption>                            </figure>                        </div>                    </div>                </div>            ";            echo $html;        }    }        public function adicionar() {        $this->data['aImagen'] = 'Adicionar';        $this->data['view'] = 'imagens/adicionar';        $this->load->view('tema/home', $this->data);    }        public function adicionarImg(){        $this->load->helper('file');                $image = $this->do_upload();	$data = array(            'nome_imagem' => $image,            'autor_imagem' => $this->input->post('autor_imagem'),            'url_imagem' => $this->input->post('url_imagem'),            'situacao_imagem' => $this->input->post('situacao_imagem'),            'data_cadastro' => date('Y-d-m H:i:s')	);	if ($this->all_model->inserirDados('imagens', $data) == TRUE) {            $this->session->set_flashdata('success', 'Imagem adicionar com sucesso!');            redirect(base_url('imagens/adicionar'));        } else {            $this->data['custom_error'] = '<div class="form_error"><p>Ocorreu um erro.</p></div>';        }    }    function do_upload(){                $this->load->library('upload');        $image_upload_folder = FCPATH . 'assets/img/bg';        if (!file_exists($image_upload_folder)) {            mkdir($image_upload_folder, DIR_WRITE_MODE, true);        }        $this->upload_config = array(            'upload_path'   => $image_upload_folder,            'allowed_types' => 'png|jpg|jpeg|bmp',            'max_size'      => 2048,	    'width'	    =>	1920,            'height'    =>  1280,            'remove_space'  => TRUE,            'encrypt_name'  => FALSE        );        $this->upload->initialize($this->upload_config);        if (!$this->upload->do_upload()) {            $upload_error = $this->upload->display_errors();            $this->session->set_flashdata('error', $upload_error);            redirect(base_url('imagens/adicionar'));            exit();        } else {            $file_info = array($this->upload->data());            return $file_info[0]['file_name'];        }    }    public function excluir() {        $id = $this->input->post('id');        if ($this->all_model->delete('usuarios', 'idUsuarios', $id) == TRUE) {            $this->session->set_flashdata('success', 'Conta excluida com sucesso!');            redirect(base_url() . 'usuarios');        } else {            $this->session->set_flashdata('error', ' Ops! algo deu errado');            redirect(base_url() . 'usuarios');        }    }}